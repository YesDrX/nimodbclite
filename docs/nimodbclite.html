<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>src/nimodbclite</title>

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="nimdoc.out.css?v=2.2.4">

<!-- JS -->
<script type="text/javascript" src="dochack.js?v=2.2.4"></script>
</head>
<body>
  <div class="document" id="documentId">
    <div class="container">
      <h1 class="title">src/nimodbclite</h1>
      <div class="row">
  <div class="three columns">
    <div class="theme-select-wrapper">
      <label for="theme-select">Theme:&nbsp;</label>
      <select id="theme-select" onchange="setTheme(this.value)">
        <option value="auto">ðŸŒ— Match OS</option>
        <option value="dark">ðŸŒ‘ Dark</option>
        <option value="light">ðŸŒ• Light</option>
      </select>
    </div>
    <div id="global-links">
      <ul class="simple">
        <li><a id="indexLink" href="theindex.html">Index</a></li>
      </ul>
    </div>
    <div id="searchInputDiv">
      Search: <input type="search" id="searchInput" oninput="search()"/>
    </div>
    <div>
      Group by:
      <select onchange="groupBy(this.value)">
        <option value="section">Section</option>
        <option value="type">Type</option>
      </select>
    </div>
    <ul class="simple simple-toc" id="toc-list">
  <li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#7" id="57">Types</a></summary>
    <ul class="simple simple-toc-section">
      <li><a class="reference" href="#OdbcConnection" title="OdbcConnection = ref OdbcConnectionObj">OdbcConnection</a></li>
<li><a class="reference" href="#OdbcConnectionObj" title="OdbcConnectionObj = object">OdbcConnectionObj</a></li>
<li><a class="reference" href="#OdbcDriverInfo" title="OdbcDriverInfo = object
  name*: string
  attributes*: seq[tuple[key: string, value: string]]">OdbcDriverInfo</a></li>
<li><a class="reference" href="#OdbcException" title="OdbcException = object of CatchableError
  sqlState*: string
  nativeError*: int">OdbcException</a></li>
<li><a class="reference" href="#ResultSet" title="ResultSet = object
  columns*: seq[SqlColumn]
  rows*: seq[seq[string]]">ResultSet</a></li>
<li><a class="reference" href="#SqlColumn" title="SqlColumn = object
  name*: string
  sqlType*: SqlDataType
  size*: int">SqlColumn</a></li>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#12" id="62">Procs</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">exec
  <li><a class="reference" href="#exec%2COdbcConnection%2Cstring" title="exec(conn: OdbcConnection; query: string): int64">exec(conn: OdbcConnection; query: string): int64</a></li>

</ul>
<ul class="simple nested-toc-section">listOdbcDrivers
  <li><a class="reference" href="#listOdbcDrivers" title="listOdbcDrivers(): seq[OdbcDriverInfo]">listOdbcDrivers(): seq[OdbcDriverInfo]</a></li>

</ul>
<ul class="simple nested-toc-section">newOdbcConnection
  <li><a class="reference" href="#newOdbcConnection%2Cstring" title="newOdbcConnection(connectionString: string): OdbcConnection">newOdbcConnection(connectionString: string): OdbcConnection</a></li>

</ul>
<ul class="simple nested-toc-section">query
  <li><a class="reference" href="#query%2COdbcConnection%2Cstring" title="query(conn: OdbcConnection; query: string): ResultSet">query(conn: OdbcConnection; query: string): ResultSet</a></li>

</ul>
<ul class="simple nested-toc-section">queryJson
  <li><a class="reference" href="#queryJson%2COdbcConnection%2Cstring" title="queryJson(conn: OdbcConnection; query: string): seq[JsonNode]">queryJson(conn: OdbcConnection; query: string): seq[JsonNode]</a></li>

</ul>

    </ul>
  </details>
</li>
<li>
  <a class="reference reference-toplevel" href="#19" id="69">Exports</a>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L1" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L1" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

    <div id="tocRoot"></div>
    
    <p class="module-desc"></p>
    <div class="section" id="6">
  <h1><a class="toc-backref" href="#6">Imports</a></h1>
  <dl class="item">
    <a class="reference external" href="nimodbclite/odbc.html">nimodbclite/odbc</a>
  </dl>
</div>
<div class="section" id="7">
  <h1><a class="toc-backref" href="#7">Types</a></h1>
  <dl class="item">
    <div id="OdbcConnection">
  <dt><pre><a href="nimodbclite.html#OdbcConnection"><span class="Identifier">OdbcConnection</span></a> <span class="Other">=</span> <span class="Keyword">ref</span> <a href="nimodbclite.html#OdbcConnectionObj"><span class="Identifier">OdbcConnectionObj</span></a></pre></dt>
  <dd>
    
    
    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L19" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L19" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="OdbcConnectionObj">
  <dt><pre><a href="nimodbclite.html#OdbcConnectionObj"><span class="Identifier">OdbcConnectionObj</span></a> <span class="Other">=</span> <span class="Keyword">object</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L14" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L14" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="OdbcDriverInfo">
  <dt><pre><a href="nimodbclite.html#OdbcDriverInfo"><span class="Identifier">OdbcDriverInfo</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">name</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">attributes</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Keyword">tuple</span><span class="Other">[</span><span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">,</span> <span class="Identifier">value</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">]</span><span class="Other">]</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L34" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L34" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="OdbcException">
  <dt><pre><a href="nimodbclite.html#OdbcException"><span class="Identifier">OdbcException</span></a> <span class="Other">=</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">CatchableError</span>
  <span class="Identifier">sqlState</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">nativeError</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L21" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L21" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="ResultSet">
  <dt><pre><a href="nimodbclite.html#ResultSet"><span class="Identifier">ResultSet</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">columns</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><a href="nimodbclite.html#SqlColumn"><span class="Identifier">SqlColumn</span></a><span class="Other">]</span>
  <span class="Identifier">rows</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">string</span><span class="Other">]</span><span class="Other">]</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L30" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L30" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="SqlColumn">
  <dt><pre><a href="nimodbclite.html#SqlColumn"><span class="Identifier">SqlColumn</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">name</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">string</span>
  <span class="Identifier">sqlType</span><span class="Operator">*</span><span class="Other">:</span> <a href="nimodbclite/odbc.html#SqlDataType"><span class="Identifier">SqlDataType</span></a>
  <span class="Identifier">size</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L25" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L25" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

  </dl>
</div>
<div class="section" id="12">
  <h1><a class="toc-backref" href="#12">Procs</a></h1>
  <dl class="item">
    <div id="exec-procs-all">
  <div id="exec,OdbcConnection,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#exec%2COdbcConnection%2Cstring"><span class="Identifier">exec</span></a><span class="Other">(</span><span class="Identifier">conn</span><span class="Other">:</span> <a href="nimodbclite.html#OdbcConnection"><span class="Identifier">OdbcConnection</span></a><span class="Other">;</span> <span class="Identifier">query</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int64</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OdbcException</span><span class="Other">,</span> <span class="Identifier">OdbcException</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Executes a SQL statement that does not return a result set.</p>
<p>This proc is intended for DDL statements (CREATE, DROP, ALTER) and DML statements (INSERT, UPDATE, DELETE) that modify data but don't return rows.</p>
<p>Parameters:</p>
<ul class="simple"><li>conn: An active OdbcConnection.</li>
<li>query: The SQL statement to execute.</li>
</ul>
<p>Returns: The number of rows affected by the statement. For DDL statements, this may be 0 or implementation-defined.</p>
<p>Raises: OdbcException if the execution fails.</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">rowsAffected</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">exec</span><span class="Punctuation">(</span><span class="StringLit">&quot;INSERT INTO users (name, age) VALUES ('Alice', 30)&quot;</span><span class="Punctuation">)</span>
<span class="Identifier">echo</span> <span class="StringLit">&quot;Inserted &quot;</span><span class="Punctuation">,</span> <span class="Identifier">rowsAffected</span><span class="Punctuation">,</span> <span class="StringLit">&quot; row(s)&quot;</span></pre></p>

    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L172" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L172" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="listOdbcDrivers-procs-all">
  <div id="listOdbcDrivers">
  <dt><pre><span class="Keyword">proc</span> <a href="#listOdbcDrivers"><span class="Identifier">listOdbcDrivers</span></a><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><a href="nimodbclite.html#OdbcDriverInfo"><span class="Identifier">OdbcDriverInfo</span></a><span class="Other">]</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OdbcException</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Lists all installed ODBC drivers on the system.</p>
<p>This proc enumerates all available ODBC drivers by using the ODBC Driver Manager. It returns information about each driver including its name and attributes (such as file paths, setup DLL, etc.).</p>
<p>Returns: A sequence of OdbcDriverInfo objects, each containing:</p>
<pre>- name: The driver name (e.g., &quot;PostgreSQL Unicode&quot;, &quot;SQLite3&quot;)
- attributes: A sequence of key-value tuples with driver attributes</pre>
<p>Raises: OdbcException if the driver enumeration fails.</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">drivers</span> <span class="Operator">=</span> <span class="Identifier">listOdbcDrivers</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Keyword">for</span> <span class="Identifier">driver</span> <span class="Keyword">in</span> <span class="Identifier">drivers</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Driver: &quot;</span><span class="Punctuation">,</span> <span class="Identifier">driver</span><span class="Operator">.</span><span class="Identifier">name</span>
  <span class="Keyword">for</span> <span class="Identifier">attr</span> <span class="Keyword">in</span> <span class="Identifier">driver</span><span class="Operator">.</span><span class="Identifier">attributes</span><span class="Punctuation">:</span>
    <span class="Identifier">echo</span> <span class="StringLit">&quot;  &quot;</span><span class="Punctuation">,</span> <span class="Identifier">attr</span><span class="Operator">.</span><span class="Identifier">key</span><span class="Punctuation">,</span> <span class="StringLit">&quot; = &quot;</span><span class="Punctuation">,</span> <span class="Identifier">attr</span><span class="Operator">.</span><span class="Identifier">value</span></pre></p>

    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L353" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L353" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="newOdbcConnection-procs-all">
  <div id="newOdbcConnection,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#newOdbcConnection%2Cstring"><span class="Identifier">newOdbcConnection</span></a><span class="Other">(</span><span class="Identifier">connectionString</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <a href="nimodbclite.html#OdbcConnection"><span class="Identifier">OdbcConnection</span></a> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OdbcException</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Creates a new ODBC connection using the provided connection string.</p>
<p>This proc allocates an ODBC environment handle, sets the ODBC version to 3.x, allocates a connection handle, and establishes a connection to the database.</p>
<p>Parameters:</p>
<ul class="simple"><li>connectionString: An ODBC connection string specifying the driver, server, database, credentials, and other options.</li>
</ul>
<p>Returns: An OdbcConnection object that can be used to execute queries.</p>
<p>Raises: OdbcException if the connection cannot be established.</p>
<p>Examples:</p>
<ul class="simple"><li><p>Windows SQL Server:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">newOdbcConnection</span><span class="Punctuation">(</span><span class="StringLit">&quot;Driver={SQL Server 17};Server=myServer;Database=myDB;Uid=user;Pwd=pass;&quot;</span><span class="Punctuation">)</span></pre></p>
</li>
<li><p>Linux PostgreSQL:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">newOdbcConnection</span><span class="Punctuation">(</span><span class="StringLit">&quot;DRIVER={PostgreSQL};SERVER=localhost;PORT=5432;DATABASE=mydb;UID=postgres;PWD=password&quot;</span><span class="Punctuation">)</span></pre></p>
</li>
<li><p>SQLite:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">db</span> <span class="Operator">=</span> <span class="Identifier">newOdbcConnection</span><span class="Punctuation">(</span><span class="StringLit">&quot;DRIVER={SQLite3};Database=test.db&quot;</span><span class="Punctuation">)</span></pre></p>
</li>
</ul>

    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L94" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L94" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="query-procs-all">
  <div id="query,OdbcConnection,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#query%2COdbcConnection%2Cstring"><span class="Identifier">query</span></a><span class="Other">(</span><span class="Identifier">conn</span><span class="Other">:</span> <a href="nimodbclite.html#OdbcConnection"><span class="Identifier">OdbcConnection</span></a><span class="Other">;</span> <span class="Identifier">query</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <a href="nimodbclite.html#ResultSet"><span class="Identifier">ResultSet</span></a> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OdbcException</span><span class="Other">,</span> <span class="Identifier">OdbcException</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Executes a SQL query and returns results with metadata and all data as strings.</p>
<p>This proc retrieves both column metadata (name, SQL type, size) and all row data. All column values are returned as strings, regardless of their actual SQL type. NULL values are represented as empty strings.</p>
<p>Parameters:</p>
<ul class="simple"><li>conn: An active OdbcConnection.</li>
<li>query: The SQL SELECT statement to execute.</li>
</ul>
<p>Returns: A ResultSet containing:</p>
<pre>- columns: Sequence of SqlColumn with name, sqlType, and size.
- rows: Sequence of sequences of strings, where each inner sequence is a row.</pre>
<p>Raises: OdbcException if the query execution fails.</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">results</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">query</span><span class="Punctuation">(</span><span class="StringLit">&quot;SELECT id, name, age FROM users&quot;</span><span class="Punctuation">)</span>
<span class="Keyword">for</span> <span class="Identifier">col</span> <span class="Keyword">in</span> <span class="Identifier">results</span><span class="Operator">.</span><span class="Identifier">columns</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Column: &quot;</span><span class="Punctuation">,</span> <span class="Identifier">col</span><span class="Operator">.</span><span class="Identifier">name</span><span class="Punctuation">,</span> <span class="StringLit">&quot; Type: &quot;</span><span class="Punctuation">,</span> <span class="Identifier">col</span><span class="Operator">.</span><span class="Identifier">sqlType</span>
<span class="Keyword">for</span> <span class="Identifier">row</span> <span class="Keyword">in</span> <span class="Identifier">results</span><span class="Operator">.</span><span class="Identifier">rows</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">row</span>  <span class="Comment"># Each row is a seq[string]</span></pre></p>

    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L230" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L230" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="queryJson-procs-all">
  <div id="queryJson,OdbcConnection,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#queryJson%2COdbcConnection%2Cstring"><span class="Identifier">queryJson</span></a><span class="Other">(</span><span class="Identifier">conn</span><span class="Other">:</span> <a href="nimodbclite.html#OdbcConnection"><span class="Identifier">OdbcConnection</span></a><span class="Other">;</span> <span class="Identifier">query</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">JsonNode</span><span class="Other">]</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OdbcException</span><span class="Other">,</span> <span class="Identifier">OdbcException</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Executes a SQL query and returns results as a sequence of JSON objects.</p>
<p>This proc converts each row into a JsonNode object, with column names as keys. It performs type-aware conversion:</p>
<ul class="simple"><li>Integer types (SqlTypeInteger, SqlTypeSmallInt) -&gt; JInt</li>
<li>Floating point types (SqlTypeFloat, SqlTypeReal, SqlTypeDouble) -&gt; JFloat</li>
<li>Other types (varchar, date, time, etc.) -&gt; JString</li>
<li>NULL values -&gt; JNull</li>
</ul>
<p>Parameters:</p>
<ul class="simple"><li>conn: An active OdbcConnection.</li>
<li>query: The SQL SELECT statement to execute.</li>
</ul>
<p>Returns: A sequence of JsonNode objects, where each JsonNode represents a row as a JSON object with column names as keys.</p>
<p>Raises: OdbcException if the query execution fails.</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">jsonResults</span> <span class="Operator">=</span> <span class="Identifier">db</span><span class="Operator">.</span><span class="Identifier">queryJson</span><span class="Punctuation">(</span><span class="StringLit">&quot;SELECT id, name, score FROM users&quot;</span><span class="Punctuation">)</span>
<span class="Keyword">for</span> <span class="Identifier">row</span> <span class="Keyword">in</span> <span class="Identifier">jsonResults</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">row</span><span class="Operator">.</span><span class="Identifier">pretty</span>  <span class="Comment"># Pretty-print the JSON</span>
<span class="Comment"># Output: {&quot;id&quot;: 1, &quot;name&quot;: &quot;Alice&quot;, &quot;score&quot;: 95.5}</span></pre></p>

    <a href="https://github.com/yesdrx/nimodbclite/tree/master/src/nimodbclite.nim#L283" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/yesdrx/nimodbclite/edit/devel/src/nimodbclite.nim#L283" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>

  </dl>
</div>
<div class="section" id="19">
  <h1><a class="toc-backref" href="#19">Exports</a></h1>
  <dl class="item">
    <a href="nimodbclite/odbc.html#SqlDataType"><span class="Identifier">SqlDataType</span></a>
  </dl>
</div>

  </div>
</div>

      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2025-12-02 14:15:23 UTC</small>
      </div>
    </div>
  </div>
  
</body>
</html>
